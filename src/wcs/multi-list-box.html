<!-- POLYMER Library -->
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-tooltip/paper-tooltip.html">

<dom-module id="multi-list-box">
    <template>
        <paper-listbox id="listboxOfFields" class="multilist" multi>

            <template is="dom-repeat" items="{{fields}}">
                <paper-item id="{{item.id}}" index="{{index}}" toggles>{{item.name}}</paper-item>
                <paper-tooltip for="{{item.id}}" position="right" animation-delay="0">{{item.description}}</paper-tooltip>
            </template>

        </paper-listbox>

        <style is="custom-style">
            paper-listbox.multilist {
                width: 200px;
            }

            paper-listbox.multilist paper-item {
                --paper-item-focused: {
                     /*background: var(--paper-amber-500);*/
                     /*font-weight: bold;*/
                 };
                --paper-item-focused-before: {
                     opacity: 0;
                 };
                --paper-item-selected: {
                     background: var(--paper-amber-500);
                 };
                --paper-item-min-height: 12px;
                cursor: pointer;
            }
        </style>
    </template>
    <script>
        Polymer({
            is: "multi-list-box",

            properties: {
                fields: { type: Array, value: [], notify: true}
            },

            listeners: {
                'iron-select': '_selectedItem',
                'iron-deselect': '_selectedItem'
            },

            _selectedItem: function(evt) {
                var idx = evt.detail.item.index;
                var hasSelectedKey = this.fields[idx].hasOwnProperty('selected'); //'selected' in this.fields[idx];
                this.fields[idx].selected = hasSelectedKey ? !this.fields[idx].selected : true;
                this.fire('selected-item', { fields: this.fields });
            }

        });
    </script>
</dom-module>